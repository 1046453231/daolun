(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/message/index"],{"0c28":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("75cb"));function o(e){return e&&e.__esModule?e:{default:e}}var u={mixins:[r.default],data:function(){return{msgList:[],upOption:{use:!1},downOption:{beforeEndDelay:500}}},methods:{goChat:function(t){e.navigateTo({url:"/pages/message/chat?data="+JSON.stringify(this.msgList[t])})},getData:function(){var t=this;return new Promise((function(n,r){var o=[],u=a.database(),i=e.getStorageSync("user_info")._id;u.collection("message").where("send_id == $cloudEnv_uid || receive_id == $cloudEnv_uid").get().then((function(e){for(var a=e.result.data,r={},u=0;u<a.length;u++){var c="",s="",d=1;if(a[u].send_id==i?(c=a[u].receive_id,s=a[u].receive_name):(c=a[u].send_id,s=a[u].send_name,d=0),r.hasOwnProperty(c)){var l=r[c],f=o[l];f.content.push(a[u]),f.last_time=Math.max(a[u].created_time,f.last_time),f.unreads+=d||0!==a[u].status?0:1,o[l]=f}else r[c]=o.length,o.push({vid:c,vname:s,content:[a[u]],last_time:a[u].created_time,unreads:d||0!==a[u].status?0:1})}for(var m=0;m<o.length;m++)o[m].content.sort((function(e,t){return e.created_time-t.created_time}));o.sort((function(e,t){return t.last_time-e.last_time})),t.msgList=o,console.log(t.msgList),n("获取消息列表成功")}))})).catch((function(){reject("获取消息列表失败")}))},downCallback:function(){var e=this;this.getData().then((function(){e.mescroll.endSuccess()})).catch((function(){e.mescroll.endErr()}))}}};t.default=u}).call(this,n("543d")["default"],n("a9ff")["default"])},"801d":function(e,t,n){"use strict";n.r(t);var a=n("d62d"),r=n("ae05");for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var u,i=n("f0c5"),c=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],u);t["default"]=c.exports},ae05:function(e,t,n){"use strict";n.r(t);var a=n("0c28"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},c45e:function(e,t,n){"use strict";(function(e){n("c22e");a(n("66fd"));var t=a(n("801d"));function a(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(t.default)}).call(this,n("543d")["createPage"])},d62d:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var a={mescrollBody:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/mescroll-uni/components/mescroll-body/mescroll-body")]).then(n.bind(null,"ed2b"))},uniDateformat:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat")]).then(n.bind(null,"298c"))}},r=function(){var e=this,t=e.$createElement;e._self._c},o=[]}},[["c45e","common/runtime","common/vendor"]]]);